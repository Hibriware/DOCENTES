{"ast":null,"code":"import _objectSpread from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import decode from'jwt-decode';import*as toastr from'toastr';var AuthService=/*#__PURE__*/function(){function AuthService(domain){_classCallCheck(this,AuthService);console.log('met constructor');this.domain=domain||'http://212.237.52.166:4000';//https://app-api-docentes.herokuapp.com\nthis.requestFetch=this.requestFetch.bind(this);this.login=this.login.bind(this);this.logout=this.logout.bind(this);this.getProfile=this.getProfile.bind(this);}_createClass(AuthService,[{key:\"login\",value:function login(usuario,password){var _this=this;console.log(usuario,password+'gsssss---');return this.requestFetch('/api/login/verificar',{method:'POST',body:JSON.stringify({usuario:usuario,password:password})}).then(function(response){console.log(response);if(response.sin==='null'){console.log('usuarios incorrectos');}else{_this.setToken(response.token);_this.setUser(response.user);return Promise.resolve(response);}toastr.warning('contraseña o usuario','Incorrectos');});}},{key:\"isLoggedIn\",value:function isLoggedIn(){console.log('met isLoggedIn');return!!this.getToken();}},{key:\"setToken\",value:function setToken(token){localStorage.setItem('token_id',token);}},{key:\"getToken\",value:function getToken(){return localStorage.getItem('token_id');}},{key:\"setUser\",value:function setUser(userJSON){localStorage.setItem('resul',JSON.stringify(userJSON));}},{key:\"getUser\",value:function getUser(){return JSON.parse(localStorage.getItem('resul'));}},{key:\"getUserAccess\",value:function getUserAccess(){var user=this.getUser();console.log(user);if(user){return user[0].nombreRol;}else{return false;}}},{key:\"getProfile\",value:function getProfile(){return decode(this.getToken());}},{key:\"logout\",value:function logout(){localStorage.removeItem('token_id');localStorage.removeItem('resul');}},{key:\"requestFetch\",value:function requestFetch(urlRelative,opcions){//inicio\nconsole.log('peticion de token');var headers={Accept:'application/json','Content-Type':'application/json'};if(this.isLoggedIn()){headers['token']=this.getToken();}return fetch(this.domain+urlRelative,_objectSpread({headers:headers},opcions)).then(function(response){return response.json();}).catch(function(error){return Promise.reject(error);});}//fin\n}]);return AuthService;}();export{AuthService as default};","map":{"version":3,"sources":["E:/Certificados/heroku/pruevaparaproduccion/DOCENTES/itsrdocentes/src/componentes/servicios/AuthService.js"],"names":["decode","toastr","AuthService","domain","console","log","requestFetch","bind","login","logout","getProfile","usuario","password","method","body","JSON","stringify","then","response","sin","setToken","token","setUser","user","Promise","resolve","warning","getToken","localStorage","setItem","getItem","userJSON","parse","getUser","nombreRol","removeItem","urlRelative","opcions","headers","Accept","isLoggedIn","fetch","json","catch","error","reject"],"mappings":"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","sourcesContent":["import decode from 'jwt-decode';\r\nimport * as toastr from 'toastr';\r\n\r\nexport default class AuthService {\r\n\tconstructor(domain) {\r\n\t\tconsole.log('met constructor');\r\n\r\n\t\tthis.domain = domain || 'http://212.237.52.166:4000'; //https://app-api-docentes.herokuapp.com\r\n\r\n\t\tthis.requestFetch = this.requestFetch.bind(this);\r\n\t\tthis.login = this.login.bind(this);\r\n\t\tthis.logout = this.logout.bind(this);\r\n\t\tthis.getProfile = this.getProfile.bind(this);\r\n\t}\r\n\tlogin(usuario, password) {\r\n\t\tconsole.log(usuario, password + 'gsssss---');\r\n\r\n\t\treturn this.requestFetch('/api/login/verificar', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: JSON.stringify({ usuario, password })\r\n\t\t}).then((response) => {\r\n\t\t\tconsole.log(response);\r\n\t\t\tif (response.sin === 'null') {\r\n\t\t\t\tconsole.log('usuarios incorrectos');\r\n\t\t\t} else {\r\n\t\t\t\tthis.setToken(response.token);\r\n\t\t\t\tthis.setUser(response.user);\r\n\t\t\t\treturn Promise.resolve(response);\r\n\t\t\t}\r\n\t\t\ttoastr.warning('contraseña o usuario', 'Incorrectos');\r\n\t\t});\r\n\t}\r\n\r\n\tisLoggedIn() {\r\n\t\tconsole.log('met isLoggedIn');\r\n\t\treturn !!this.getToken();\r\n\t}\r\n\r\n\tsetToken(token) {\r\n\t\tlocalStorage.setItem('token_id', token);\r\n\t}\r\n\r\n\tgetToken() {\r\n\t\treturn localStorage.getItem('token_id');\r\n\t}\r\n\r\n\tsetUser(userJSON) {\r\n\t\tlocalStorage.setItem('resul', JSON.stringify(userJSON));\r\n\t}\r\n\r\n\tgetUser() {\r\n\t\treturn JSON.parse(localStorage.getItem('resul'));\r\n\t}\r\n\r\n\tgetUserAccess() {\r\n\t\tlet user = this.getUser();\r\n\t\tconsole.log(user);\r\n\t\tif (user) {\r\n\t\t\treturn user[0].nombreRol;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tgetProfile() {\r\n\t\treturn decode(this.getToken());\r\n\t}\r\n\r\n\tlogout() {\r\n\t\tlocalStorage.removeItem('token_id');\r\n\t\tlocalStorage.removeItem('resul');\r\n\t}\r\n\r\n\trequestFetch(urlRelative, opcions) {\r\n\t\t//inicio\r\n\t\tconsole.log('peticion de token');\r\n\r\n\t\tconst headers = {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t};\r\n\t\tif (this.isLoggedIn()) {\r\n\t\t\theaders['token'] = this.getToken();\r\n\t\t}\r\n\t\treturn fetch(this.domain + urlRelative, {\r\n\t\t\theaders,\r\n\t\t\t...opcions\r\n\t\t})\r\n\t\t\t.then((response) => response.json())\r\n\t\t\t.catch((error) => Promise.reject(error));\r\n\t} //fin\r\n}\r\n"]},"metadata":{},"sourceType":"module"}