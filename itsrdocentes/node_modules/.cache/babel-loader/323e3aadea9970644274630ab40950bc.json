{"ast":null,"code":"import _objectSpread from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\Certificados\\\\heroku\\\\pruevaparaproduccion\\\\DOCENTES\\\\itsrdocentes\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import decode from'jwt-decode';import*as toastr from'toastr';var AuthService=/*#__PURE__*/function(){function AuthService(domain){_classCallCheck(this,AuthService);console.log('met constructor');this.domain=domain||'http://212.237.52.166:4000';//https://app-api-docentes.herokuapp.com\nthis.requestFetch=this.requestFetch.bind(this);this.login=this.login.bind(this);this.logout=this.logout.bind(this);this.getProfile=this.getProfile.bind(this);}_createClass(AuthService,[{key:\"login\",value:function login(usuario,password){var _this=this;try{console.log(usuario,password+'gsssss---');return this.requestFetch('/api/login/verificar',{method:'POST',body:JSON.stringify({usuario:usuario,password:password})}).then(function(response){console.log(response);if(response.message==='ocurrio un error'||response.message==='contrase単a incorrecta'){console.log('usuarios incorrectos');}else{_this.setToken(response.token);_this.setUser(response.user);return Promise.resolve(response);}toastr.warning('contrase単a o usuario','Incorrectos');});}catch(error){console.log(error);}}},{key:\"isLoggedIn\",value:function isLoggedIn(){try{console.log('met isLoggedIn');return!!this.getToken();}catch(error){console.log(error);}}},{key:\"setToken\",value:function setToken(token){try{localStorage.setItem('token_id',token);}catch(error){console.log(error);}}},{key:\"getToken\",value:function getToken(){try{return localStorage.getItem('token_id');}catch(error){console.log(error);}}},{key:\"setUser\",value:function setUser(userJSON){try{localStorage.setItem('resul',JSON.stringify(userJSON));}catch(error){console.log(error);}}},{key:\"getUser\",value:function getUser(){try{return JSON.parse(localStorage.getItem('resul'));}catch(error){console.log(error);}}},{key:\"getUserAccess\",value:function getUserAccess(){try{var user=this.getUser();console.log(user);if(user){return user[0].nombreRol;}else{return false;}}catch(error){console.log(error);}}},{key:\"getProfile\",value:function getProfile(){try{return decode(this.getToken());}catch(error){console.log(error);}}},{key:\"logout\",value:function logout(){try{localStorage.removeItem('token_id');localStorage.removeItem('resul');}catch(error){console.log(error);}}},{key:\"requestFetch\",value:function requestFetch(urlRelative,opcions){//inicio\ntry{console.log('peticion de token');var headers={Accept:'application/json','Content-Type':'application/json'};if(this.isLoggedIn()){headers['token']=this.getToken();}return fetch(this.domain+urlRelative,_objectSpread({headers:headers},opcions)).then(function(response){return response.json();}).catch(function(error){return Promise.reject(error);});}catch(error){console.log(error);}}//fin\n}]);return AuthService;}();export{AuthService as default};","map":{"version":3,"sources":["E:/Certificados/heroku/pruevaparaproduccion/DOCENTES/itsrdocentes/src/componentes/servicios/AuthService.js"],"names":["decode","toastr","AuthService","domain","console","log","requestFetch","bind","login","logout","getProfile","usuario","password","method","body","JSON","stringify","then","response","message","setToken","token","setUser","user","Promise","resolve","warning","error","getToken","localStorage","setItem","getItem","userJSON","parse","getUser","nombreRol","removeItem","urlRelative","opcions","headers","Accept","isLoggedIn","fetch","json","catch","reject"],"mappings":"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","sourcesContent":["import decode from 'jwt-decode';\r\nimport * as toastr from 'toastr';\r\n\r\nexport default class AuthService {\r\n\tconstructor(domain) {\r\n\t\tconsole.log('met constructor');\r\n\r\n\t\tthis.domain = domain || 'http://212.237.52.166:4000'; //https://app-api-docentes.herokuapp.com\r\n\r\n\t\tthis.requestFetch = this.requestFetch.bind(this);\r\n\t\tthis.login = this.login.bind(this);\r\n\t\tthis.logout = this.logout.bind(this);\r\n\t\tthis.getProfile = this.getProfile.bind(this);\r\n\t}\r\n\tlogin(usuario, password) {\r\n\t\ttry {\r\n\t\t\tconsole.log(usuario, password + 'gsssss---');\r\n\r\n\t\t\treturn this.requestFetch('/api/login/verificar', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: JSON.stringify({ usuario, password })\r\n\t\t\t}).then((response) => {\r\n\t\t\t\tconsole.log(response);\r\n\t\t\t\tif (response.message === 'ocurrio un error' || response.message === 'contrase単a incorrecta') {\r\n\t\t\t\t\tconsole.log('usuarios incorrectos');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setToken(response.token);\r\n\t\t\t\t\tthis.setUser(response.user);\r\n\t\t\t\t\treturn Promise.resolve(response);\r\n\t\t\t\t}\r\n\t\t\t\ttoastr.warning('contrase単a o usuario', 'Incorrectos');\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tisLoggedIn() {\r\n\t\ttry {\r\n\t\t\tconsole.log('met isLoggedIn');\r\n\t\t\treturn !!this.getToken();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tsetToken(token) {\r\n\t\ttry {\r\n\t\t\tlocalStorage.setItem('token_id', token);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tgetToken() {\r\n\t\ttry {\r\n\t\t\treturn localStorage.getItem('token_id');\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tsetUser(userJSON) {\r\n\t\ttry {\r\n\t\t\tlocalStorage.setItem('resul', JSON.stringify(userJSON));\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tgetUser() {\r\n\t\ttry {\r\n\t\t\treturn JSON.parse(localStorage.getItem('resul'));\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tgetUserAccess() {\r\n\t\ttry {\r\n\t\t\tlet user = this.getUser();\r\n\t\t\tconsole.log(user);\r\n\t\t\tif (user) {\r\n\t\t\t\treturn user[0].nombreRol;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tgetProfile() {\r\n\t\ttry {\r\n\t\t\treturn decode(this.getToken());\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tlogout() {\r\n\t\ttry {\r\n\t\t\tlocalStorage.removeItem('token_id');\r\n\t\t\tlocalStorage.removeItem('resul');\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\trequestFetch(urlRelative, opcions) {\r\n\t\t//inicio\r\n\t\ttry {\r\n\t\t\tconsole.log('peticion de token');\r\n\r\n\t\t\tconst headers = {\r\n\t\t\t\tAccept: 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t};\r\n\t\t\tif (this.isLoggedIn()) {\r\n\t\t\t\theaders['token'] = this.getToken();\r\n\t\t\t}\r\n\t\t\treturn fetch(this.domain + urlRelative, {\r\n\t\t\t\theaders,\r\n\t\t\t\t...opcions\r\n\t\t\t})\r\n\t\t\t\t.then((response) => response.json())\r\n\t\t\t\t.catch((error) => Promise.reject(error));\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t} //fin\r\n}\r\n"]},"metadata":{},"sourceType":"module"}