{"ast":null,"code":"var _jsxFileName = \"C:\\\\programasproyectos\\\\Certificados\\\\itsrdocentes\\\\itsrdocentes\\\\src\\\\componentes\\\\contenedores\\\\docente_calificaciones\\\\Tabla_registro.js\";\nimport React from 'react';\nimport MaterialTable from 'material-table';\nimport MenuCreterios from './establecerCriterios';\nimport * as toastr from 'toastr';\nimport { crearCalificacion, updateCalificaion, getAlumnos, datalistaAlumnos } from '../../servicios/api';\nimport './calificaciones.css';\nimport { id_criterios, unidadCalificacion } from './select_temas';\nexport const TablaCapturaCalificaciones = React.memo(datas => {\n  const [open, setOpen] = React.useState(false);\n  console.log('memo Tabla registro ');\n  const {\n    alumnos,\n    setcalificaciones,\n    calificaciones,\n    ccx1,\n    ccx2,\n    ccx3,\n    ccx4\n  } = datas;\n\n  const guardarPromedio = async datos => {\n    //inicio  enviar el promedio asignado en la tabla captura_calificacion\n    let bandera = datos.materiaDocente_id;\n    let idcalificacion = datos.idcalificaciones;\n\n    if (bandera) {\n      if (datos.calR1 === null && datos.calR2 === null && datos.calR3 === null && datos.calR4 === null) {\n        datos.calR1 = 0;\n        datos.calR2 = 0;\n        datos.calR3 = 0;\n        datos.calR4 = 0;\n      } else if (datos.calR2 === null && datos.calR3 === null && datos.calR4 === null) {\n        datos.calR2 = 0;\n        datos.calR3 = 0;\n        datos.calR4 = 0;\n      } else if (datos.calR3 === null && datos.calR4 === null) {\n        datos.calR3 = 0;\n        datos.calR4 = 0;\n      } else if (datos.calR4 === null) {\n        datos.calR4 = 0;\n      }\n\n      await updateCalificaion(idcalificacion, datos);\n    } else {\n      //crear registro para el alumno en registro calificacion\n      console.log('unidadCalificacion  v');\n      console.log(unidadCalificacion);\n      await crearCalificacion(datos, unidadCalificacion, id_criterios);\n      await getAlumnos(datos.idMateria, unidadCalificacion); //LISTA DE ALUMNOS\n\n      await setcalificaciones({\n        datalistaAlumnos: datalistaAlumnos\n      });\n    }\n  }; //fin\n\n\n  const handleClickOpen = () => {\n    if (datas.unidad.length) {\n      setOpen(true);\n    } else {\n      toastr.info('Seleccione una Materia y un Tema', 'Nota');\n    }\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return React.createElement(\"div\", {\n    style: {\n      maxWidth: '100%'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, React.createElement(MenuCreterios, {\n    handleClose: handleClose,\n    open: open,\n    updates: datas.updates,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }), React.createElement(MaterialTable, {\n    margin: \"none\",\n    size: \"small\",\n    title: \"Captura de calificaciones\",\n    columns: alumnos.columns //columnas\n    ,\n    data: calificaciones.datalistaAlumnos //filas\n    ,\n    editable: {\n      onRowUpdate: (newData, oldData) => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n\n          if (oldData) {\n            setcalificaciones(prevState => {\n              const datalistaAlumnos = [...prevState.datalistaAlumnos]; //obtenr data\n\n              console.log(ccx1);\n              console.log('ccx1*');\n              console.log(newData.calCriterio1 = Math.round(parseInt(newData.calR1) * (ccx1 / 100)));\n              console.log(newData.calCriterio2 = Math.round(parseInt(newData.calR2) * (ccx2 / 100)));\n              console.log(newData.calCriterio3 = Math.round(parseInt(newData.calR3) * (ccx3 / 100)));\n              console.log(newData.calCriterio4 = Math.round(parseInt(newData.calR4) * (ccx4 / 100)));\n              console.log(newData.calificaciontotal = parseInt(newData.calCriterio1) + parseInt(newData.calCriterio2) + parseInt(newData.calCriterio3) + parseInt(newData.calCriterio4));\n              console.log(newData); //estado fila modificado\n\n              datalistaAlumnos[datalistaAlumnos.indexOf(oldData)] = newData;\n              guardarPromedio(newData);\n              return { ...prevState,\n                datalistaAlumnos\n              };\n            });\n          }\n        }, 600);\n      })\n    },\n    options: {\n      headerStyle: {\n        backgroundColor: '#01579b',\n        color: '#FFF',\n        size: 'small'\n      },\n      rowStyle: {\n        white: 'pre'\n      }\n    },\n    actions: [{\n      icon: 'edit',\n      tooltip: 'Editat criterios',\n      isFreeAction: true,\n      onClick: event => handleClickOpen()\n    }],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }));\n});","map":{"version":3,"sources":["C:/programasproyectos/Certificados/itsrdocentes/itsrdocentes/src/componentes/contenedores/docente_calificaciones/Tabla_registro.js"],"names":["React","MaterialTable","MenuCreterios","toastr","crearCalificacion","updateCalificaion","getAlumnos","datalistaAlumnos","id_criterios","unidadCalificacion","TablaCapturaCalificaciones","memo","datas","open","setOpen","useState","console","log","alumnos","setcalificaciones","calificaciones","ccx1","ccx2","ccx3","ccx4","guardarPromedio","datos","bandera","materiaDocente_id","idcalificacion","idcalificaciones","calR1","calR2","calR3","calR4","idMateria","handleClickOpen","unidad","length","info","handleClose","maxWidth","updates","columns","onRowUpdate","newData","oldData","Promise","resolve","setTimeout","prevState","calCriterio1","Math","round","parseInt","calCriterio2","calCriterio3","calCriterio4","calificaciontotal","indexOf","headerStyle","backgroundColor","color","size","rowStyle","white","icon","tooltip","isFreeAction","onClick","event"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport MaterialTable from 'material-table';\r\nimport MenuCreterios from './establecerCriterios';\r\nimport *as toastr from 'toastr';\r\nimport { crearCalificacion, updateCalificaion, getAlumnos, datalistaAlumnos } from '../../servicios/api';\r\nimport './calificaciones.css';\r\nimport { id_criterios, unidadCalificacion } from './select_temas';\r\n\r\n\r\n\r\nexport const TablaCapturaCalificaciones = React.memo((datas) => {\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  console.log('memo Tabla registro ')\r\n  const { alumnos, setcalificaciones, calificaciones, ccx1, ccx2, ccx3, ccx4 } = datas;\r\n\r\n  const guardarPromedio = async (datos) => {//inicio  enviar el promedio asignado en la tabla captura_calificacion\r\n\r\n    let bandera = datos.materiaDocente_id;\r\n    let idcalificacion = datos.idcalificaciones;\r\n\r\n    if (bandera) {\r\n      if(datos.calR1 === null && datos.calR2 === null && datos.calR3 === null && datos.calR4 === null){\r\n        datos.calR1 = 0;\r\n        datos.calR2 = 0;\r\n        datos.calR3 = 0;\r\n        datos.calR4 = 0;\r\n      }\r\n      else if (datos.calR2 === null && datos.calR3 === null && datos.calR4 === null) {\r\n        datos.calR2 = 0;\r\n        datos.calR3 = 0;\r\n        datos.calR4 = 0;\r\n      } else if (datos.calR3 === null && datos.calR4 === null) {\r\n        datos.calR3 = 0;\r\n        datos.calR4 = 0;\r\n      } else if (datos.calR4 === null) {\r\n        datos.calR4 = 0;\r\n      }\r\n      await updateCalificaion(idcalificacion, datos)\r\n    } else {//crear registro para el alumno en registro calificacion\r\n      console.log('unidadCalificacion  v')\r\n\r\n      console.log(unidadCalificacion)\r\n      await crearCalificacion(datos, unidadCalificacion, id_criterios);\r\n      await getAlumnos(datos.idMateria, unidadCalificacion);//LISTA DE ALUMNOS\r\n      await setcalificaciones({ datalistaAlumnos: datalistaAlumnos });\r\n    }\r\n  }//fin\r\n\r\n  const handleClickOpen = () => {\r\n    if(datas.unidad.length){\r\n      setOpen(true);\r\n\r\n    }else{\r\n      toastr.info('Seleccione una Materia y un Tema', 'Nota');\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n\r\n  return (\r\n    <div style={{maxWidth:'100%'}}>\r\n      <MenuCreterios handleClose={handleClose} open={open} updates={datas.updates} />\r\n    <MaterialTable  margin=\"none\" size=\"small\"\r\n      title=\"Captura de calificaciones\"\r\n      columns={alumnos.columns}//columnas\r\n      data={calificaciones.datalistaAlumnos}//filas\r\n      editable={\r\n        {\r\n          onRowUpdate: (newData, oldData) =>\r\n            new Promise(resolve => {\r\n              setTimeout(() => {\r\n                resolve();\r\n                if (oldData) {\r\n                  setcalificaciones(prevState => {\r\n                    const datalistaAlumnos = [...prevState.datalistaAlumnos];//obtenr data\r\n                    console.log(ccx1)\r\n                    console.log('ccx1*')\r\n\r\n                    console.log(newData.calCriterio1 = (Math.round(parseInt(newData.calR1) * (ccx1 / 100))))\r\n                    console.log(newData.calCriterio2 = (Math.round(parseInt(newData.calR2) * (ccx2 / 100))))\r\n                    console.log(newData.calCriterio3 = (Math.round(parseInt(newData.calR3) * (ccx3 / 100))))\r\n                    console.log(newData.calCriterio4 = (Math.round(parseInt(newData.calR4) * (ccx4 / 100))))\r\n                    console.log(newData.calificaciontotal = (parseInt(newData.calCriterio1) + parseInt(newData.calCriterio2) + parseInt(newData.calCriterio3) + parseInt(newData.calCriterio4)))\r\n                    console.log(newData)//estado fila modificado\r\n                    datalistaAlumnos[datalistaAlumnos.indexOf(oldData)] = newData;\r\n                    guardarPromedio(newData)\r\n                    return { ...prevState, datalistaAlumnos };\r\n                  });\r\n                }\r\n              }, 600);\r\n            }),\r\n        }\r\n      }\r\n      options={{\r\n        headerStyle: {\r\n          backgroundColor: '#01579b',\r\n          color: '#FFF',\r\n          size: 'small'\r\n        },\r\n        rowStyle: {\r\n          white: 'pre',\r\n        },\r\n      }} \r\n      actions={[\r\n        {\r\n          icon: 'edit',\r\n          tooltip: 'Editat criterios',\r\n          isFreeAction: true,\r\n          onClick: (event) => handleClickOpen()\r\n        }\r\n      ]}\r\n      />\r\n      </div>\r\n  );\r\n})"]},"metadata":{},"sourceType":"module"}